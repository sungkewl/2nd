
    @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

:root{
  --bg:#0b1220; --panel:#0f1628; --text:#e6edf7; --muted:#9fb0ca; --border:#1a2337;
  --accent:#5c94fc; --accent-2:#7acbff; --accent-3:#FFD700;
}

*{ box-sizing:border-box; }
body{
  margin:0;
  background:
    radial-gradient(1000px 500px at 50% -200px, rgba(140,170,255,.20), transparent 60%),
    radial-gradient(800px 400px at 10% 80%, rgba(120,200,255,.12), transparent 60%),
    var(--bg);
  color:var(--text);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,"Noto Sans KR",sans-serif,"Press Start 2P";
}

h1{ color:var(--accent-3); padding: 20px 0;; font-family: 'Press Start 2P', cursive;text-shadow: 2px 2px #000; font-size: 24px; text-align: center;}

/* Î†àÏù¥ÏïÑÏõÉ: Ï¢å/Ï§ë/Ïö∞ 3Ïó¥ */
#main-container{
  display:grid;
  grid-template-columns: 300px 1fr 320px; /* Ï¢å/Ï§ë/Ïö∞ */
  gap:16px;
  max-width:1280px;
  margin:0 auto;
  padding:12px 16px 24px;
}

.panel{
  background:var(--panel);
  border:1px solid var(--border);
  border-radius:14px;
  padding:12px;
  box-shadow:0 10px 30px rgba(0,0,0,.35);
  min-height:480px;
  overflow:auto;

}

 
#center-panel{
  display:grid;
  place-items:center;
  background:transparent;
  border:none;
  box-shadow:none;
  min-height:520px;  
  padding:0;
}

/* ÏôºÏ™Ω Î≤ÑÌäº UI */
#menu-buttons{ display:grid; gap:8px; margin-top:12px; }
.menu-btn{
  appearance:none;
  border:1px solid var(--border);
  background:rgba(255,255,255,.04);
  color:var(--text);
  padding:9px 12px;
  border-radius:10px;
  font-weight:700;
  font-size:14px;
  cursor:pointer;
  transition:transform .06s ease, box-shadow .2s ease, border-color .2s ease, background .2s ease;
}
.menu-btn:hover{
  border-color:#2a3550;
  background:rgba(255,255,255,.07);
  box-shadow:0 8px 20px rgba(0,0,0,.35);
  transform:translateY(-1px);
}

/* Ïö∞Ï∏° Ìå®ÎÑê: ÌîåÎ†àÏù¥Ïñ¥ Ï†ïÎ≥¥ */
#player-portrait{
  display:block; width:100%; max-width:180px; margin:6px auto 8px; image-rendering:pixelated;
  border-radius:10px; border:1px solid var(--border);
  box-shadow:0 10px 24px rgba(0,0,0,.35); background:rgba(255,255,255,.02);
}
#player-stats p{ margin:4px 0 6px; }

/* ÏßÑÌñâÎ∞î(Ïª®ÌÖåÏù¥ÎÑà = Ìä∏Îûô, ÎÇ¥Î∂Ä .progress-bar = Ï±ÑÏõÄ) */
.progress-bar-container{
  position:relative;
  display:flex; align-items:center; gap:8px;
  margin:6px 0 2px;
  background:rgba(255,255,255,.08);    /* Ìä∏Îûô Î∞∞Í≤Ω */
  border-radius:999px;
  padding:0; height:12px;
}
.progress-bar{
  height:12px; width:0%; border-radius:999px;
  background:linear-gradient(90deg, var(--accent), var(--accent-2));
  box-shadow:inset 0 0 0 1px rgba(255,255,255,.25), 0 1px 0 rgba(0,0,0,.4);
  transition:width .35s ease;
  flex:1 1 auto;
}
#player-xp-text{
  font-size:12px; color:var(--muted); min-width:64px; text-align:right; margin-left:8px;
}

/* Î±ÉÏßÄ */
#badge-container{ display:flex; flex-wrap:wrap; gap:8px; margin-top:8px; }
.badge{
  width:36px; height:36px; border-radius:8px; border:1px solid var(--border);
  background-color:rgba(255,255,255,.04); background-size:cover; background-position:center;
  box-shadow:inset 0 0 0 1px rgba(255,255,255,.03);
}
.home-float-btn {
  position: fixed;
  bottom: 20px;
  right: 20px;
  width: 56px;
  height: 56px;
  border-radius: 50%;
  background-color: hsl(39, 90%, 54%);
  color: #fff;
  font-size: 26px;
  display: flex;
  align-items: center;
  justify-content: center;
  text-decoration: none;
  box-shadow: 0 4px 8px rgba(0,0,0,0.25);
  transition: background-color 0.25s, transform 0.15s;
  z-index: 1000; /* Îã§Î•∏ ÏöîÏÜå ÏúÑÎ°ú */
}

.home-float-btn:hover {
  background: #357ab9;
  transform: scale(1.05);
}

/* Î∞òÏùëÌòï */
@media (max-width:1200px){
  #main-container{ grid-template-columns: 280px 1fr; }
  #center-panel{ justify-self:center; align-self:start; }
  #right-panel{ grid-column: 1 / -1; }
}
@media (max-width:680px){
  #main-container{ grid-template-columns: 1fr; }
  #center-panel{ order:-1; min-height:420px; }
  #player-portrait{ max-width:140px; }
}

/* ========== Grammar Quest: Board Layers ========== */
#game-world{
  position:relative;
  width:512px;   /* 16 * 32 */
  height:288px;  /*  9 * 32 */
  border:1px solid var(--border);
  border-radius:10px;
  background:
    linear-gradient(transparent 31px, rgba(255,255,255,.04) 32px),
    linear-gradient(90deg, transparent 31px, rgba(255,255,255,.04) 32px),
    linear-gradient(180deg, #0e1424, #0b1220);
  background-size:32px 32px, 32px 32px, auto;
  box-shadow:inset 0 0 0 1px rgba(255,255,255,.04), 0 10px 24px rgba(0,0,0,.35);
  image-rendering: pixelated;
  
}
/* ÌöåÏ†Ñ ÏïàÎÇ¥ Ïò§Î≤ÑÎ†àÏù¥ */
#rotate-hint{
  position:absolute; inset:0; display:none; align-items:center; justify-content:center;
  background: rgba(0,0,0,.6); color:#fff; font-weight:800; text-shadow:0 2px 6px rgba(0,0,0,.7);
  font-size:18px; letter-spacing:.5px; z-index:5;
}
@media (max-width:680px){
  #rotate-hint{ display:flex; }
}
.layer{ position:absolute; inset:0; }
.tile{ position:absolute; width:32px; height:32px; }
.tile.floor{ background:rgba(255,255,255,.01); }
.tile.wall{
  background:#1b2740;
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.05);
}
.tile.gate{
  background: repeating-linear-gradient(90deg, #3b2b61 0 6px, #281c46 6px 12px);
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.06);
}
/* 3D-ish crates */
.tile.box-blue,
.tile.box-gray,
.tile.box-green{
  background: #2b2b2b;
  border-radius:4px;
  box-shadow:
    inset 0 0 0 1px rgba(0,0,0,.5),
    inset 0 6px 0 rgba(255,255,255,.06),
    inset 0 -6px 0 rgba(0,0,0,.3),
    0 2px 0 rgba(0,0,0,.35);
  position:relative;
}
.tile.box-blue{ background:#204a8f; }
.tile.box-gray{ background:#596272; }
.tile.box-green{ background:#216c4b; }
.tile.box-blue::before,
.tile.box-gray::before,
.tile.box-green::before{
  content:"";
  position:absolute; inset:4px;
  border:2px solid rgba(0,0,0,.35);
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.08);
}
.tile.box-gray{ outline: 2px solid rgba(255,255,255,.15); }
.tile.box-blue::after{ content:"üéÅ"; position:absolute; right:3px; bottom:1px; font-size:14px; }
.tile.box-gray::after{ content:"‚ö†Ô∏è"; position:absolute; right:3px; bottom:1px; font-size:14px; }
.tile.box-green::after{ content:"‚ú®"; position:absolute; right:3px; bottom:1px; font-size:14px; }

/* Entities */
.player{ position:absolute; width:28px; height:28px; margin:2px; border-radius:6px; background:#ffcc4d; box-shadow:0 2px 0 rgba(0,0,0,.5); }
.npc{ position:absolute; width:28px; height:28px; margin:2px; border-radius:10px; background:#7acbff; box-shadow:0 2px 0 rgba(0,0,0,.5); }
.face{ position:absolute; inset:0; display:block; }
.eye{ position:absolute; top:8px; width:4px; height:6px; background:#2b2b2b; border-radius:2px; box-shadow:0 1px 0 rgba(255,255,255,.3) inset; }
.eye.left{ left:7px; }
.eye.right{ right:7px; }
.eye.wink{ width:6px; height:2px; top:10px; background:#2b2b2b; border-radius:2px; }
.mouth{ position:absolute; left:50%; transform:translateX(-50%); bottom:7px; width:10px; height:6px; border:2px solid #2b2b2b; border-top:none; border-radius:0 0 10px 10px; background:transparent; }

/* Key badge */
#key-badge{
  position:absolute; top:-12px; left:-12px;
  display:inline-flex; align-items:center; gap:6px;
  padding:6px 10px;
  border:1px solid var(--border);
  border-radius:999px;
  background:rgba(12,18,34,.85);
  color:var(--text);
  box-shadow:0 4px 14px rgba(0,0,0,.35), inset 0 0 0 1px rgba(255,255,255,.05);
  font-weight:700;
  z-index:2;
}
#key-badge .icon{ filter: drop-shadow(0 1px 0 rgba(0,0,0,.4)); }
#key-badge.bump{ animation: key-bump .35s ease; }
@keyframes key-bump{
  0%{ transform:scale(1); }
  35%{ transform:scale(1.12); }
  100%{ transform:scale(1); }
}

/* Utility */
.hidden{ display:none !important; }
.label{ position:absolute; left:50%; transform:translateX(-50%); color:#fff; font-size:12px; text-shadow:0 1px 2px rgba(0,0,0,.8); }
.label.up{ bottom:32px; }

/* QA row and loot log */
.qa-row{ display:flex; gap:8px; margin-top:8px; }
#q-input{ flex:1; padding:8px 10px; border-radius:8px; border:1px solid var(--border); background:rgba(255,255,255,.06); color:var(--text); }
#q-submit{ padding:8px 12px; border-radius:8px; border:1px solid var(--border); background:rgba(255,255,255,.08); color:var(--text); cursor:pointer; }

/* ===== Mobile Controls (D-Pad) ===== */
#mobile-controls{
  position: fixed;
  bottom: 16px;
  left: 16px;
  display: none;
  width: 160px;
  height: 160px;
  grid-template-columns: repeat(3, 1fr);
  grid-template-rows: repeat(3, 1fr);
  gap: 8px;
  z-index: 1200;
  pointer-events: none; /* container ignores events */
}
#mobile-controls .mc-btn{
  pointer-events: auto; /* buttons accept events */
  appearance: none;
  background: rgba(255,255,255,.1);
  color: var(--text);
  border: 1px solid var(--border);
  border-radius: 12px;
  font-size: 18px;
  display: flex; align-items: center; justify-content: center;
  box-shadow: 0 6px 16px rgba(0,0,0,.35);
}
#mobile-controls .mc-btn:active{
  transform: translateY(1px);
  background: rgba(255,255,255,.18);
}
#mobile-controls .up{ grid-column: 2; grid-row: 1; }
#mobile-controls .left{ grid-column: 1; grid-row: 2; }
#mobile-controls .right{ grid-column: 3; grid-row: 2; }
#mobile-controls .down{ grid-column: 2; grid-row: 3; }

@media (max-width: 680px){
  #mobile-controls{ display: grid; }
}
.loot-log{ margin-top:10px; font-size:13px; color:var(--muted); min-height:18px; }
/* Rule Book modal */
#rulebook-overlay { position: fixed; inset: 0; display: flex; align-items: center; justify-content: center; background: rgba(0,0,0,.55); z-index: 10000; }
#rulebook-overlay.hidden { display: none; }
.rulebook { width: min(90vw, 640px); max-height: 80vh; background: #ffffff; border: 3px solid #c8a97e; box-shadow: 0 10px 30px rgba(0,0,0,.35); border-radius: 10px; overflow: hidden; font-family: 'Press Start 2P', system-ui, sans-serif; color: #1f2937; }
.rb-header { display: flex; align-items: center; justify-content: space-between; padding: 10px 14px; background: #f0e0c7; border-bottom: 2px solid #c8a97e; color: #2b2114; }
#rulebook-title { font-size: 14px; }
.rb-close { background: transparent; border: 0; font-size: 20px; line-height: 1; cursor: pointer; color: #2b2114; }
.rb-content { padding: 14px; overflow: auto; max-height: calc(80vh - 110px); }
.rb-text { margin: 0; white-space: pre-wrap; font-size: 14px; line-height: 1.7; letter-spacing: 0.2px; color: #1f2937; }
.rb-footer { padding: 8px 14px; background: #f7eddc; border-top: 2px solid #c8a97e; font-size: 11px; color: #4a3620; }
.rb-hint { opacity: .9; }

/* typing caret */
.typing .rb-text { position: relative; }
.typing .rb-text::after { content: ''; position: absolute; width: 8px; height: 1em; background: #1f2937; opacity: .85; animation: caret .8s steps(1) infinite; margin-left: 4px; top: 0; }
@keyframes caret { 0% { opacity: 0; } 50% { opacity: 1; } 100% { opacity: 0; } }

/* ===============================
   Avatar Widget (local styles for gr)
   =============================== */
.avatar-widget { display: grid; grid-template-columns: auto 1fr; gap: 10px; align-items: center; }
.avatar-figure {
  width: 64px;
  height: 64px;
  border-radius: 16px;
  display: block;
  background-repeat: no-repeat;
  image-rendering: pixelated;
  box-shadow: inset 0 2px 6px rgba(0,0,0,.25), 0 4px 12px rgba(0,0,0,.15);
}
.avatar-title { font-weight: 700; }
.avatar-desc { font-size: 12px; color: var(--muted); }

/* ===============================
   Responsive fixes (overflow + breakpoints)
   =============================== */
html, body{ overflow-x: hidden; }

/* allow center column to shrink without forcing horizontal scroll */
#main-container{ grid-template-columns: 300px minmax(0,1fr) 320px; }

/* reduce side column widths around ~1200px to avoid overflow */
@media (max-width: 1260px){
  #main-container{ grid-template-columns: 260px minmax(0,1fr) 280px; }
}
@media (max-width: 1180px){
  #main-container{ grid-template-columns: 240px minmax(0,1fr) 260px; }
}
@media (max-width: 1060px){
  #main-container{ grid-template-columns: 1fr; }
  #center-panel{ order:-1; }
}

/* ensure game area does not cause page-level horizontal scroll */
#center-panel{ overflow-x: hidden; }

/* --- Home Button (FAB) override --- */
.home-float-btn{
  background: radial-gradient(120% 120% at 30% 25%, rgba(255,255,255,.25), rgba(255,255,255,0) 35%), #4da3ff !important;
  color:#fff !important;
  box-shadow: 0 10px 18px rgba(0,0,0,.35), inset 0 0 0 2px rgba(255,255,255,.2) !important;
  transition: transform .12s ease, box-shadow .2s ease, filter .2s ease !important;
  font-size:26px !important;
}
.home-float-btn:hover{ transform: translateY(-2px); filter: brightness(1.05); }
.home-float-btn:active{ transform: translateY(0); }
